#!/usr/bin/env ruby

require 'bundler/setup'
require 'wp2hatena'

print 'CONSUMER_KEY：'
CONSUMER_KEY = gets.chomp
print 'CONSUMER_SECRET：'
CONSUMER_SECRET = gets.chomp
print 'ACCESS_TOKEN：'
ACCESS_TOKEN = gets.chomp
print 'ACCESS_TOKEN_SECRET：'
ACCESS_TOKEN_SECRET = gets.chomp

print 'WORDPRESS_XML_PATH：'
WORDPRESS_XML_PATH = gets.chomp

fotolife = Wp2hatena::Hatena::Fotolife.new(
    CONSUMER_KEY,
    CONSUMER_SECRET,
    ACCESS_TOKEN,
    ACCESS_TOKEN_SECRET
)

image = Wp2hatena::Wordpress::Image.new
image.download(WORDPRESS_XML_PATH) do |data|
  file_path = data[:file_path]
  response = fotolife.upload(
      file_path,
      File.basename(file_path, '.*')
  )
end
